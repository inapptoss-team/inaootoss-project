# 📘 inapptoss 프로젝트 세부 설계서 (v1)

---
## 1️⃣ 프로젝트 개요

**프로젝트명:** inapptoss  
**개발 목표:** HTML5 기반 인터랙티브 1인칭 어드벤처 게임  
**플랫폼:** Android (Java → Kotlin 전환 예정)  
**UI 구성:** Android WebView + HTML5 Canvas (픽셀 해상도 기반)

---
## 2️⃣ 개발 환경 및 기술 스택

| 항목 | 내용 |
|------|------|
| IDE | Android Studio, IntelliJ IDEA |
| 언어 | Java (1차), Kotlin (2차 전환 예정) |
| 빌드 | Gradle |
| 프레임워크 | Android Jetpack, WebView |
| 데이터 저장 | SharedPreferences, Room (예정) |
| 렌더링 | HTML5 Canvas + WebView |
| 버전관리 | Git / GitHub |
| 협업 | Notion + Discord + GitHub Projects |

---
## 3️⃣ 패키지 구조 및 역할

```
app/src/main/java/com/example/inapptoss/
 ├─ bridge/               # JS ↔ Android 연결
 │   ├─ GameBridge.java
 │   └─ UiBridge.java
 │
 ├─ core/                 # 게임 핵심 로직
 │   ├─ model/            # 데이터 모델
 │   │   ├─ GameSave.java
 │   │   ├─ PlayerState.java
 │   │   └─ PuzzleData.java
 │   ├─ puzzle/           # 퍼즐 엔진
 │   │   ├─ PuzzleEngine.java
 │   │   ├─ PuzzleValidator.java
 │   │   └─ PuzzleFactory.java
 │   └─ utils/            # 공통 유틸리티
 │       ├─ JsonUtils.java
 │       ├─ FileUtils.java
 │       ├─ LogUtils.java
 │       └─ ResourceUtils.java
 │
 ├─ data/                 # 저장소 계층
 │   ├─ local/            # SharedPreferences, Room
 │   │   ├─ SaveLocalDataSource.java
 │   │   └─ SettingsLocalDataSource.java
 │   └─ repository/
 │       ├─ SaveRepository.java
 │       └─ PlayerRepository.java
 │
 ├─ manager/              # 메인 로직 계층
 │   ├─ game/
 │   │   ├─ GameManager.java
 │   │   ├─ GameStateManager.java
 │   │   ├─ PlayerManager.java
 │   │   ├─ ResourceManager.java
 │   │   └─ UiManager.java
 │   ├─ map/
 │   │   └─ MapManager.java
 │   ├─ puzzle/
 │   │   ├─ HintManager.java
 │   │   └─ PuzzleManager.java
 │   └─ script/
 │       └─ ScriptManager.java
 │
 ├─ ui/                   # Android UI 계층 (Activity, Fragment)
 │   ├─ activity/
 │   │   ├─ MainActivity.java
 │   │   ├─ LabActivity.java
 │   │   ├─ CultActivity.java
 │   │   └─ SchoolActivity.java
 │   └─ viewmodel/        # 화면 상태 관리
 │
 ├─ MainApplication.java
 └─ MainActivity.java
```

---
## 4️⃣ 주요 매니저 설계 요약

### 🎮 GameManager
- 전체 게임의 중앙 제어기
- 하위 매니저들을 소유하고 이벤트를 조정함

```java
GameStateManager stateManager;
PlayerManager playerManager;
ResourceManager resourceManager;
UIManager uiManager;
PuzzleManager puzzleManager;
MapManager mapManager;
ScriptManager scriptManager;
```

**주요 메서드**
- `init()` : 전체 매니저 초기화
- `startGame()` : 스테이지 진입
- `saveGame()` / `loadGame()` : 진행도 관리
- `onEventTriggered(eventId)` : 스크립트 / 퍼즐 호출

---

### 🧩 PuzzleManager
- 퍼즐의 생성, 실행, 종료를 관리
- `InEventPuzzle()` / `OutEventPuzzle()` 지원
- `HintManager`를 통해 힌트 기능 제공

```java
callPuzzle(id)
inEventPuzzle(id)
outPuzzle()
outEventPuzzle()
showHint()
```

---

### 🗺️ MapManager
- 스테이지 이동 / 메인화면 복귀 / 다음 스테이지 진입

```java
callMap(stageId)
outMap()
nextMap()
```

---

### 📜 ScriptManager
- 캐릭터 독백 / 상호작용 스크립트 제어
- JSON 기반으로 파싱된 대사를 이벤트 트리거와 연동

---

### 🧠 GameStateManager
- 저장 / 불러오기 / 진행도 관리
- `data/local` 과 연동

---

### 🧍 PlayerManager
- 플레이어 상태 관리 (hp, 위치, 아이템 등)

---

### 🖼️ UIManager
- HUD, 메뉴, 팝업 등 화면 전반 UI 제어
- WebView 기반 HTML HUD와 상호작용 가능

---

### 🗃️ ResourceManager
- JSON, 이미지, 사운드 등 리소스 로딩
- assets/ 폴더와 core/utils/ 연동

---

## 5️⃣ HTML ↔ Android 연동 구조

```
HTML (JS)
  ↓
UiBridge / GameBridge
  ↓
Manager (GameManager, PuzzleManager, etc.)
  ↓
Core (model/puzzle/utils)
  ↓
Data (repository/local)
  ↓
저장소 or 리소스 파일
```

---
## 6️⃣ 개발 단계 제안

| 단계 | 목표 | 주요 작업 |
|------|------|------------|
| 1단계 | Core & Manager 구축 | GameManager, PuzzleManager 기본 로직 |
| 2단계 | Bridge 연동 | WebView ↔ Android 통신 |
| 3단계 | UI 제작 | HTML5 Canvas + WebView HUD |
| 4단계 | 퍼즐 구현 | PuzzleEngine + 데이터 바인딩 |
| 5단계 | 스테이지 분리 | 연구실 / 교단 / 학원 팀 분업 |
| 6단계 | 저장/불러오기 | GameStateManager + Repository 연결 |
| 7단계 | 코틀린 전환 | 점진적 리팩토링 |
| 8단계 | 디버깅 및 빌드 | 최종 테스트 및 배포 |

---
## 7️⃣ 추가 제안

- **코어 로직 분리** : core/ 모듈은 별도 라이브러리화 가능
- **퍼즐 JSON 포맷 표준화** : PuzzleData 구조 정의 필요
- **리소스 매핑 표** : ResourceManager가 관리할 데이터 목록 사전 정의
- **Bridge 통신 로그 추가** : JS 호출 디버깅 편의성 확보

---
_본 문서는 inapptoss 프로젝트의 1차 세부 설계 기준입니다._  
_추후 Kotlin 전환 시 `core/` 계층부터 리팩토링을 권장합니다._
